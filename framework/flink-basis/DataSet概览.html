<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>复盘笔记知识分享</title>
    <meta name="description" content="review notes">
    <meta name="generator" content="VuePress 1.3.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/github-markdown-css/2.10.0/github-markdown.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.7b068616.css" as="style"><link rel="preload" href="/assets/js/app.50205751.js" as="script"><link rel="preload" href="/assets/js/2.d9cbdc2c.js" as="script"><link rel="preload" href="/assets/js/43.3bb77f33.js" as="script"><link rel="prefetch" href="/assets/js/10.38f78d39.js"><link rel="prefetch" href="/assets/js/100.06acbc4e.js"><link rel="prefetch" href="/assets/js/101.9e2b21ca.js"><link rel="prefetch" href="/assets/js/102.e61d51bc.js"><link rel="prefetch" href="/assets/js/103.37fa77ea.js"><link rel="prefetch" href="/assets/js/104.906b73a7.js"><link rel="prefetch" href="/assets/js/105.c0b81c43.js"><link rel="prefetch" href="/assets/js/106.51dcf9cb.js"><link rel="prefetch" href="/assets/js/107.6a352281.js"><link rel="prefetch" href="/assets/js/108.f8d50074.js"><link rel="prefetch" href="/assets/js/109.a63b0890.js"><link rel="prefetch" href="/assets/js/11.6499e51e.js"><link rel="prefetch" href="/assets/js/110.08e5a8c4.js"><link rel="prefetch" href="/assets/js/111.c13d0d53.js"><link rel="prefetch" href="/assets/js/112.fb47e69e.js"><link rel="prefetch" href="/assets/js/113.f839cc9d.js"><link rel="prefetch" href="/assets/js/114.848c249a.js"><link rel="prefetch" href="/assets/js/115.323eb661.js"><link rel="prefetch" href="/assets/js/116.78a4b2db.js"><link rel="prefetch" href="/assets/js/117.80745107.js"><link rel="prefetch" href="/assets/js/118.cd1fc500.js"><link rel="prefetch" href="/assets/js/119.43c5221f.js"><link rel="prefetch" href="/assets/js/12.96547204.js"><link rel="prefetch" href="/assets/js/120.96132f67.js"><link rel="prefetch" href="/assets/js/121.67365210.js"><link rel="prefetch" href="/assets/js/122.bfb0a2d6.js"><link rel="prefetch" href="/assets/js/123.7cd54a47.js"><link rel="prefetch" href="/assets/js/124.15a3a27a.js"><link rel="prefetch" href="/assets/js/125.cc5f66e7.js"><link rel="prefetch" href="/assets/js/126.396ef902.js"><link rel="prefetch" href="/assets/js/127.10390703.js"><link rel="prefetch" href="/assets/js/128.af5248d2.js"><link rel="prefetch" href="/assets/js/129.34772395.js"><link rel="prefetch" href="/assets/js/13.d6bb1d26.js"><link rel="prefetch" href="/assets/js/130.9a7aad8f.js"><link rel="prefetch" href="/assets/js/131.93c57c77.js"><link rel="prefetch" href="/assets/js/132.4e11e487.js"><link rel="prefetch" href="/assets/js/133.33d8f27a.js"><link rel="prefetch" href="/assets/js/134.2cecf5d2.js"><link rel="prefetch" href="/assets/js/135.a2ad9f3f.js"><link rel="prefetch" href="/assets/js/136.27c812ee.js"><link rel="prefetch" href="/assets/js/137.cbb29391.js"><link rel="prefetch" href="/assets/js/138.919f4b66.js"><link rel="prefetch" href="/assets/js/139.a5b6e8a2.js"><link rel="prefetch" href="/assets/js/14.60ee8507.js"><link rel="prefetch" href="/assets/js/140.ad300898.js"><link rel="prefetch" href="/assets/js/141.9e66cebe.js"><link rel="prefetch" href="/assets/js/142.96f59f24.js"><link rel="prefetch" href="/assets/js/143.66a29b32.js"><link rel="prefetch" href="/assets/js/144.aceaabd1.js"><link rel="prefetch" href="/assets/js/145.03b87174.js"><link rel="prefetch" href="/assets/js/146.a96168a1.js"><link rel="prefetch" href="/assets/js/147.b0d72570.js"><link rel="prefetch" href="/assets/js/148.9e7d2a95.js"><link rel="prefetch" href="/assets/js/149.36a9ed56.js"><link rel="prefetch" href="/assets/js/15.e5825dc9.js"><link rel="prefetch" href="/assets/js/150.980014b9.js"><link rel="prefetch" href="/assets/js/151.87b87027.js"><link rel="prefetch" href="/assets/js/152.859e8d91.js"><link rel="prefetch" href="/assets/js/153.4a35aacb.js"><link rel="prefetch" href="/assets/js/154.f40384c4.js"><link rel="prefetch" href="/assets/js/155.f9a8e74c.js"><link rel="prefetch" href="/assets/js/156.6b5c26eb.js"><link rel="prefetch" href="/assets/js/157.f6b91780.js"><link rel="prefetch" href="/assets/js/158.9bf41875.js"><link rel="prefetch" href="/assets/js/159.d4c743c9.js"><link rel="prefetch" href="/assets/js/16.4b38696e.js"><link rel="prefetch" href="/assets/js/160.39f512ad.js"><link rel="prefetch" href="/assets/js/161.1b6e204f.js"><link rel="prefetch" href="/assets/js/162.c7ebeac4.js"><link rel="prefetch" href="/assets/js/163.804e8f31.js"><link rel="prefetch" href="/assets/js/164.0d69a62f.js"><link rel="prefetch" href="/assets/js/165.40dd4465.js"><link rel="prefetch" href="/assets/js/166.e9af9bb2.js"><link rel="prefetch" href="/assets/js/167.e4f02241.js"><link rel="prefetch" href="/assets/js/168.dd990181.js"><link rel="prefetch" href="/assets/js/169.31bbd359.js"><link rel="prefetch" href="/assets/js/17.272048e5.js"><link rel="prefetch" href="/assets/js/170.c494751d.js"><link rel="prefetch" href="/assets/js/171.f5e9d2a9.js"><link rel="prefetch" href="/assets/js/172.9534e6f1.js"><link rel="prefetch" href="/assets/js/173.74009aee.js"><link rel="prefetch" href="/assets/js/174.ea5100b3.js"><link rel="prefetch" href="/assets/js/175.401c4f26.js"><link rel="prefetch" href="/assets/js/176.185274da.js"><link rel="prefetch" href="/assets/js/177.a27081a8.js"><link rel="prefetch" href="/assets/js/178.72a8a903.js"><link rel="prefetch" href="/assets/js/179.402a790e.js"><link rel="prefetch" href="/assets/js/18.04fbbdeb.js"><link rel="prefetch" href="/assets/js/180.046dcb23.js"><link rel="prefetch" href="/assets/js/181.fecb3471.js"><link rel="prefetch" href="/assets/js/182.52fbc03c.js"><link rel="prefetch" href="/assets/js/183.f3b43f1f.js"><link rel="prefetch" href="/assets/js/184.d09edaf3.js"><link rel="prefetch" href="/assets/js/185.dd8d4ed5.js"><link rel="prefetch" href="/assets/js/186.206e0c78.js"><link rel="prefetch" href="/assets/js/187.b2645833.js"><link rel="prefetch" href="/assets/js/188.9439b901.js"><link rel="prefetch" href="/assets/js/189.46021272.js"><link rel="prefetch" href="/assets/js/19.6abcc2b0.js"><link rel="prefetch" href="/assets/js/190.66ac20ae.js"><link rel="prefetch" href="/assets/js/191.8036e519.js"><link rel="prefetch" href="/assets/js/192.a1f33c79.js"><link rel="prefetch" href="/assets/js/193.3b7af780.js"><link rel="prefetch" href="/assets/js/20.a071e2ba.js"><link rel="prefetch" href="/assets/js/21.7a302f2f.js"><link rel="prefetch" href="/assets/js/22.5ca84009.js"><link rel="prefetch" href="/assets/js/23.44a9017d.js"><link rel="prefetch" href="/assets/js/24.94e33725.js"><link rel="prefetch" href="/assets/js/25.6bea65bc.js"><link rel="prefetch" href="/assets/js/26.84eda376.js"><link rel="prefetch" href="/assets/js/27.072a2ba9.js"><link rel="prefetch" href="/assets/js/28.6963f469.js"><link rel="prefetch" href="/assets/js/29.1d59d52d.js"><link rel="prefetch" href="/assets/js/3.7330c88c.js"><link rel="prefetch" href="/assets/js/30.7bab7afa.js"><link rel="prefetch" href="/assets/js/31.f0155c43.js"><link rel="prefetch" href="/assets/js/32.5c81d573.js"><link rel="prefetch" href="/assets/js/33.ed3a7dcb.js"><link rel="prefetch" href="/assets/js/34.fe5423da.js"><link rel="prefetch" href="/assets/js/35.b98669cc.js"><link rel="prefetch" href="/assets/js/36.056a9e90.js"><link rel="prefetch" href="/assets/js/37.88cb1f1d.js"><link rel="prefetch" href="/assets/js/38.49fe8553.js"><link rel="prefetch" href="/assets/js/39.bb6a4110.js"><link rel="prefetch" href="/assets/js/4.39154e1a.js"><link rel="prefetch" href="/assets/js/40.83dce21d.js"><link rel="prefetch" href="/assets/js/41.9a29d4d4.js"><link rel="prefetch" href="/assets/js/42.e80e58ee.js"><link rel="prefetch" href="/assets/js/44.0b3bd69c.js"><link rel="prefetch" href="/assets/js/45.8fb09d3e.js"><link rel="prefetch" href="/assets/js/46.347445f1.js"><link rel="prefetch" href="/assets/js/47.3ea463e2.js"><link rel="prefetch" href="/assets/js/48.1bc32c98.js"><link rel="prefetch" href="/assets/js/49.91311b10.js"><link rel="prefetch" href="/assets/js/5.56039607.js"><link rel="prefetch" href="/assets/js/50.208f3455.js"><link rel="prefetch" href="/assets/js/51.a7506c23.js"><link rel="prefetch" href="/assets/js/52.8a110ebb.js"><link rel="prefetch" href="/assets/js/53.e5286e65.js"><link rel="prefetch" href="/assets/js/54.0843d696.js"><link rel="prefetch" href="/assets/js/55.06bd95c1.js"><link rel="prefetch" href="/assets/js/56.03143e32.js"><link rel="prefetch" href="/assets/js/57.2b2b286f.js"><link rel="prefetch" href="/assets/js/58.af4df46c.js"><link rel="prefetch" href="/assets/js/59.9601cb14.js"><link rel="prefetch" href="/assets/js/6.2045a40b.js"><link rel="prefetch" href="/assets/js/60.bd84bbba.js"><link rel="prefetch" href="/assets/js/61.c6f59274.js"><link rel="prefetch" href="/assets/js/62.f80301e2.js"><link rel="prefetch" href="/assets/js/63.78659b78.js"><link rel="prefetch" href="/assets/js/64.3b212fe7.js"><link rel="prefetch" href="/assets/js/65.7ae4bba3.js"><link rel="prefetch" href="/assets/js/66.28498a62.js"><link rel="prefetch" href="/assets/js/67.fffb4581.js"><link rel="prefetch" href="/assets/js/68.db557a19.js"><link rel="prefetch" href="/assets/js/69.f3cdedbc.js"><link rel="prefetch" href="/assets/js/7.42b8a1f0.js"><link rel="prefetch" href="/assets/js/70.c07b4c36.js"><link rel="prefetch" href="/assets/js/71.d15e9513.js"><link rel="prefetch" href="/assets/js/72.8b651efe.js"><link rel="prefetch" href="/assets/js/73.9cbe22c5.js"><link rel="prefetch" href="/assets/js/74.0180e166.js"><link rel="prefetch" href="/assets/js/75.4cd119ce.js"><link rel="prefetch" href="/assets/js/76.e96e76ff.js"><link rel="prefetch" href="/assets/js/77.7e9ddad5.js"><link rel="prefetch" href="/assets/js/78.154878f7.js"><link rel="prefetch" href="/assets/js/79.80646765.js"><link rel="prefetch" href="/assets/js/8.b07be786.js"><link rel="prefetch" href="/assets/js/80.4426ba73.js"><link rel="prefetch" href="/assets/js/81.f46323be.js"><link rel="prefetch" href="/assets/js/82.6a2962e6.js"><link rel="prefetch" href="/assets/js/83.319f6ec8.js"><link rel="prefetch" href="/assets/js/84.2ea763c9.js"><link rel="prefetch" href="/assets/js/85.3a245fa2.js"><link rel="prefetch" href="/assets/js/86.7fa9d03e.js"><link rel="prefetch" href="/assets/js/87.8b02cecc.js"><link rel="prefetch" href="/assets/js/88.f2b78822.js"><link rel="prefetch" href="/assets/js/89.1447c3dc.js"><link rel="prefetch" href="/assets/js/9.268c8dd6.js"><link rel="prefetch" href="/assets/js/90.359b8b7f.js"><link rel="prefetch" href="/assets/js/91.b7a31f84.js"><link rel="prefetch" href="/assets/js/92.abcc097d.js"><link rel="prefetch" href="/assets/js/93.b409a582.js"><link rel="prefetch" href="/assets/js/94.23da69f6.js"><link rel="prefetch" href="/assets/js/95.d30980f3.js"><link rel="prefetch" href="/assets/js/96.800e6b23.js"><link rel="prefetch" href="/assets/js/97.2dd2d2fe.js"><link rel="prefetch" href="/assets/js/98.549739a0.js"><link rel="prefetch" href="/assets/js/99.4ade6164.js">
    <link rel="stylesheet" href="/assets/css/0.styles.7b068616.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">复盘笔记知识分享</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/language/java-core/" class="nav-link">
  Java 核心知识
</a></li><li class="dropdown-item"><!----> <a href="/language/java-concurrency/" class="nav-link">
  Java 并发编程
</a></li><li class="dropdown-item"><!----> <a href="/language/java-jvm/" class="nav-link">
  Java JVM-虚拟机
</a></li><li class="dropdown-item"><!----> <a href="/language/scala-basis/" class="nav-link">
  Scala 基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术框架" class="dropdown-title"><span class="title">技术框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/spark-basis/" class="nav-link">
  Spark 基础
</a></li><li class="dropdown-item"><!----> <a href="/framework/flink-basis/" class="nav-link router-link-active">
  Flink 基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DevOps" class="dropdown-title"><span class="title">DevOps</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/devops/dev-tools/" class="nav-link">
  工具收藏系列
</a></li></ul></div></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试题
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/学习方法.html" class="nav-link">
  学习方法
</a></li><li class="dropdown-item"><!----> <a href="/about/贡献说明.html" class="nav-link">
  贡献说明
</a></li></ul></div></div> <a href="https://github.com/GourdErwa/review-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程语言" class="dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/language/java-core/" class="nav-link">
  Java 核心知识
</a></li><li class="dropdown-item"><!----> <a href="/language/java-concurrency/" class="nav-link">
  Java 并发编程
</a></li><li class="dropdown-item"><!----> <a href="/language/java-jvm/" class="nav-link">
  Java JVM-虚拟机
</a></li><li class="dropdown-item"><!----> <a href="/language/scala-basis/" class="nav-link">
  Scala 基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="技术框架" class="dropdown-title"><span class="title">技术框架</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/framework/spark-basis/" class="nav-link">
  Spark 基础
</a></li><li class="dropdown-item"><!----> <a href="/framework/flink-basis/" class="nav-link router-link-active">
  Flink 基础
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="DevOps" class="dropdown-title"><span class="title">DevOps</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/devops/dev-tools/" class="nav-link">
  工具收藏系列
</a></li></ul></div></div><div class="nav-item"><a href="/interview/" class="nav-link">
  面试题
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="关于" class="dropdown-title"><span class="title">关于</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/about/学习方法.html" class="nav-link">
  学习方法
</a></li><li class="dropdown-item"><!----> <a href="/about/贡献说明.html" class="nav-link">
  贡献说明
</a></li></ul></div></div> <a href="https://github.com/GourdErwa/review-notes" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>Flink 基础概念</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/framework/flink-basis/基础概念.html" class="sidebar-link">基础概念</a></li><li><a href="/framework/flink-basis/运行环境.html" class="sidebar-link">运行环境</a></li><li><a href="/framework/flink-basis/编程模型.html" class="sidebar-link">编程模型</a></li><li><a href="/framework/flink-basis/类型系统.html" class="sidebar-link">类型系统</a></li><li><a href="/framework/flink-basis/开发前准备与模拟数据集介绍.html" class="sidebar-link">开发前准备与模拟数据集介绍</a></li><li><a href="/framework/flink-basis/基础API概览.html" class="sidebar-link">基础API概览</a></li><li><a href="/framework/flink-basis/Environment概览.html" class="sidebar-link">Environment概览</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>DataSet（Batch）</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/framework/flink-basis/DataSet概览.html" class="active sidebar-link">DataSet概览</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/framework/flink-basis/DataSet概览.html#_1-示例程序" class="sidebar-link">1 示例程序</a></li><li class="sidebar-sub-header"><a href="/framework/flink-basis/DataSet概览.html#_2-程序数据源输入（data-sources）" class="sidebar-link">2 程序数据源输入（Data Sources）</a></li><li class="sidebar-sub-header"><a href="/framework/flink-basis/DataSet概览.html#_3-程序数据输出（data-sinks）" class="sidebar-link">3 程序数据输出（Data Sinks）</a></li><li class="sidebar-sub-header"><a href="/framework/flink-basis/DataSet概览.html#_4-转换操作（transformations）" class="sidebar-link">4 转换操作（Transformations）</a></li></ul></li><li><a href="/framework/flink-basis/DataSet分配唯一标识符.html" class="sidebar-link">DataSet分配唯一标识符</a></li><li><a href="/framework/flink-basis/DataSet参数传递.html" class="sidebar-link">DataSet参数传递</a></li><li><a href="/framework/flink-basis/DataSet广播变量.html" class="sidebar-link">DataSet广播变量</a></li><li><a href="/framework/flink-basis/DataSet分布式缓冲.html" class="sidebar-link">DataSet分布式缓冲</a></li><li><a href="/framework/flink-basis/DataSet语义注解.html" class="sidebar-link">DataSet语义注解</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>DataStream（Streaming）</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/framework/flink-basis/DataStream概览.html" class="sidebar-link">DataStream概览</a></li><li><a href="/framework/flink-basis/DataStream时间水印机制.html" class="sidebar-link">DataStream时间水印机制</a></li><li><a href="/framework/flink-basis/DataStream-ProcessFunction.html" class="sidebar-link">DataStream-ProcessFunction</a></li><li><a href="/framework/flink-basis/DataStream窗口机制.html" class="sidebar-link">DataStream窗口机制</a></li><li><a href="/framework/flink-basis/DataStream窗口功能函数.html" class="sidebar-link">DataStream窗口功能函数</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><blockquote><p>专栏原创出处：<a href="https://github.com/GourdErwa/review-notes/tree/master/framework/flink-basis" target="_blank" rel="noopener noreferrer">github-源笔记文件 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ，<a href="https://github.com/GourdErwa/flink-advanced" target="_blank" rel="noopener noreferrer">github-源码 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，欢迎 Star，转载请附上原文出处链接和本声明。<br>
本节内容部分<a href="https://github.com/GourdErwa/flink-advanced/blob/master/src/main/scala/io/gourd/flink/scala/games/batch/transformations" target="_blank" rel="noopener noreferrer">源码 <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote> <p></p><div class="table-of-contents"><ul><li><a href="#_1-示例程序">1 示例程序</a></li><li><a href="#_2-程序数据源输入（data-sources）">2 程序数据源输入（Data Sources）</a><ul><li><a href="#_2-1-基于文件：">2.1 基于文件：</a></li><li><a href="#_2-2-基于集合：">2.2 基于集合：</a></li><li><a href="#_2-3-通用：">2.3 通用：</a></li></ul></li><li><a href="#_3-程序数据输出（data-sinks）">3 程序数据输出（Data Sinks）</a></li><li><a href="#_4-转换操作（transformations）">4 转换操作（Transformations）</a><ul><li><a href="#_4-1-map">4.1 Map</a></li><li><a href="#_4-2-flatmap">4.2 FlatMap</a></li><li><a href="#_4-3-mappartition">4.3 MapPartition</a></li><li><a href="#_4-4-filter">4.4 Filter</a></li><li><a href="#_4-5-projection-of-tuple-dataset（元组数据集投影）">4.5 Projection of Tuple DataSet（元组数据集投影）</a></li><li><a href="#_4-6-transformations-on-grouped-dataset（分组数据集的转换）">4.6 Transformations on Grouped DataSet（分组数据集的转换）</a></li><li><a href="#_4-7-reduce-on-grouped-dataset（减少分组数据集）">4.7 Reduce on Grouped DataSet（减少分组数据集）</a></li><li><a href="#_4-8-groupreduce-on-grouped-dataset（分组数据集上的-groupreduce）">4.8 GroupReduce on Grouped DataSet（分组数据集上的 GroupReduce）</a></li><li><a href="#_4-9-可组合的-groupreduce-函数">4.9 可组合的 GroupReduce 函数</a></li><li><a href="#_4-10-groupcombine-on-a-grouped-dataset（分组数据集上的-groupcombine）">4.10 GroupCombine on a Grouped DataSet（分组数据集上的 GroupCombine）</a></li><li><a href="#_4-11-aggregate-on-grouped-tuple-dataset（在分组元组数据集聚合）">4.11 Aggregate on Grouped Tuple DataSet（在分组元组数据集聚合）</a></li><li><a href="#_4-12-minby-maxby-on-grouped-tuple-dataset（分组元组数据集上的-minby-maxby）">4.12 MinBy / MaxBy on Grouped Tuple DataSet（分组元组数据集上的 MinBy / MaxBy）</a></li><li><a href="#_4-13-reduce-on-full-dataset（减少完整的-dataset）">4.13 Reduce on full DataSet（减少完整的 DataSet）</a></li><li><a href="#_4-14-groupreduce-on-full-dataset（完整数据集上的-groupreduce）">4.14 GroupReduce on full DataSet（完整数据集上的 GroupReduce）</a></li><li><a href="#_4-15-groupcombine-on-a-full-dataset（完整数据集上的-groupcombine）">4.15 GroupCombine on a full DataSet（完整数据集上的 GroupCombine）</a></li><li><a href="#_4-16-aggregate-on-full-tuple-dataset（完整数据集上聚合）">4.16 Aggregate on full Tuple DataSet（完整数据集上聚合）</a></li><li><a href="#_4-17-minby-maxby-on-full-tuple-dataset（完整数据集上的-minby-maxby）">4.17 MinBy/MaxBy on full Tuple DataSet（完整数据集上的 MinBy/MaxBy）</a></li><li><a href="#_4-18-distinct（去重）">4.18 Distinct（去重）</a></li><li><a href="#_4-19-join">4.19 Join</a></li><li><a href="#_4-20-outerjoin">4.20 OuterJoin</a></li><li><a href="#_4-21-cross">4.21 Cross</a></li><li><a href="#_4-22-cogroup">4.22 CoGroup</a></li><li><a href="#_4-23-union">4.23 Union</a></li><li><a href="#_4-24-rebalance-重新平衡">4.24 Rebalance(重新平衡)</a></li><li><a href="#_4-25-hash-partition-哈希分区">4.25 Hash-Partition(哈希分区)</a></li><li><a href="#_4-26-range-partition（范围分区）">4.26 Range-Partition（范围分区）</a></li><li><a href="#_4-27-sort-partition（分区排序）">4.27 Sort Partition（分区排序）</a></li><li><a href="#_4-28-first-n（前-n-个（任意）元素）">4.28 First-n（前 n 个（任意）元素）</a></li></ul></li></ul></div><p></p> <h2 id="_1-示例程序"><a href="#_1-示例程序" class="header-anchor">#</a> 1 示例程序</h2> <p><a href="https://github.com/GourdErwa/flink-advanced/blob/master/src/main/scala/io/gourd/flink/scala/games/batch/Batch.scala" target="_blank" rel="noopener noreferrer">Batch.scala<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token comment">// 操作原始 DataSet API 完成 2 个表数据过滤 join 聚合操作</span>
<span class="token keyword">object</span> BatchDataSet <span class="token keyword">extends</span> BatchExecutionEnvironmentApp <span class="token punctuation">{</span>

  <span class="token comment">// 用户登录数据 DataSet</span>
  <span class="token keyword">val</span> userLoginDataSet <span class="token operator">=</span> DataSet<span class="token punctuation">.</span>userLogin<span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token comment">// 角色登录数据 DataSet</span>
  <span class="token keyword">val</span> roleLoginDataSet <span class="token operator">=</span> DataSet<span class="token punctuation">.</span>roleLogin<span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>

  userLoginDataSet
    <span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>dataUnix <span class="token operator">&gt;</span> <span class="token number">1571414499</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>status <span class="token operator">==</span> <span class="token string">&quot;LOGIN&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>join<span class="token punctuation">(</span>roleLoginDataSet<span class="token punctuation">,</span> JoinHint<span class="token punctuation">.</span>BROADCAST_HASH_FIRST<span class="token punctuation">)</span><span class="token punctuation">.</span>where<span class="token punctuation">(</span>_<span class="token punctuation">.</span>uid<span class="token punctuation">)</span><span class="token punctuation">.</span>equalTo<span class="token punctuation">(</span>_<span class="token punctuation">.</span>uid<span class="token punctuation">)</span>
    <span class="token punctuation">.</span>apply<span class="token punctuation">(</span><span class="token punctuation">(</span>left<span class="token punctuation">,</span> _<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> left<span class="token punctuation">.</span>platform <span class="token operator">-&gt;</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>sum<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>sortPartition<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> Order<span class="token punctuation">.</span>ASCENDING<span class="token punctuation">)</span>
    <span class="token punctuation">.</span>print<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 操作 Table API 完成 2 个表数据过滤 join 聚合操作</span>
<span class="token keyword">object</span> BatchTable <span class="token keyword">extends</span> BatchTableEnvironmentApp <span class="token punctuation">{</span>

  <span class="token keyword">private</span> <span class="token keyword">val</span> userLogin <span class="token operator">=</span> RegisterDataSet<span class="token punctuation">.</span>userLogin<span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> <span class="token keyword">val</span> roleLogin <span class="token operator">=</span> RegisterDataSet<span class="token punctuation">.</span>roleLogin<span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>

  btEnv<span class="token punctuation">.</span>scan<span class="token punctuation">(</span>userLogin<span class="token punctuation">)</span>
    <span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">&quot;platform,dataUnix,uid,status&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token string">'dataUnix &gt; 1571414499 &amp;&amp; '</span>status <span class="token operator">==</span><span class="token operator">=</span> <span class="token string">&quot;LOGIN&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>join<span class="token punctuation">(</span>btEnv<span class="token punctuation">.</span>scan<span class="token punctuation">(</span>roleLogin<span class="token punctuation">)</span><span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">&quot;uid as r_uid&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">&quot;uid = r_uid&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token string">&quot;platform&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>select<span class="token punctuation">(</span><span class="token string">&quot;platform as p , count(platform) as c&quot;</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>orderBy<span class="token punctuation">(</span><span class="token symbol">'c</span><span class="token punctuation">.</span>asc<span class="token punctuation">)</span>
    <span class="token punctuation">.</span>toDataSet<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Long</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">.</span>print<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 操作 SQL 完成 2 个表数据过滤 join 聚合操作</span>
<span class="token keyword">object</span> BatchSQL <span class="token keyword">extends</span> BatchTableEnvironmentApp <span class="token punctuation">{</span>

  <span class="token keyword">private</span> <span class="token keyword">val</span> table <span class="token operator">=</span> RegisterDataSet<span class="token punctuation">.</span>userLogin<span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>

  btEnv<span class="token punctuation">.</span>sqlQuery<span class="token punctuation">(</span>
    s<span class="token triple-quoted-string string">&quot;&quot;&quot;
       |SELECT platform AS p,COUNT(platform) AS c FROM
       |(
       |SELECT platform,dataUnix,uid,status FROM $table
       |WHERE dataUnix &gt; 0 AND status = 'LOGIN'
       |)
       |GROUP BY platform
       |&quot;&quot;&quot;</span><span class="token punctuation">.</span>stripMargin<span class="token punctuation">)</span>
    <span class="token punctuation">.</span>toDataSet<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Long</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token punctuation">.</span>print<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_2-程序数据源输入（data-sources）"><a href="#_2-程序数据源输入（data-sources）" class="header-anchor">#</a> 2 程序数据源输入（Data Sources）</h2> <h3 id="_2-1-基于文件："><a href="#_2-1-基于文件：" class="header-anchor">#</a> 2.1 基于文件：</h3> <ul><li><code>readTextFile(path)// TextInputFormat</code>-逐行读取文件，并将它们作为字符串返回。</li> <li><code>readTextFileWithValue(path)// TextValueInputFormat</code>-逐行读取文件，并将它们作为 StringValues 返回。StringValues 是可变字符串。</li> <li><code>readCsvFile(path)// CsvInputFormat</code>-解析以逗号（或其他字符）分隔的字段的文件。返回元组，case class 对象或 POJO 的数据集。支持基本的 Java 类型及其与 Value 相对应的字段类型。</li> <li><code>readFileOfPrimitives(path, delimiter)</code>// PrimitiveInputFormat-解析以换行符（或其他 char 序列）定界的原始数据类型的文件，例如 String 或 Integer 使用给定的定界符。</li> <li><code>readSequenceFile(Key, Value, path)</code>// SequenceFileInputFormat-创建 JobConf 并从指定的路径中读取类型为 SequenceFileInputFormat，Key 类和 Value 类的文件，并将它们作为 Tuple2 &lt;Key，Value&gt; 返回。</li></ul> <h3 id="_2-2-基于集合："><a href="#_2-2-基于集合：" class="header-anchor">#</a> 2.2 基于集合：</h3> <ul><li><code>fromCollection(Iterable)</code>-从 Iterable 创建数据集。Iterable 返回的所有元素都必须是同一类型。</li> <li><code>fromCollection(Iterator)</code>-从迭代器创建数据集。该类指定迭代器返回的元素的数据类型。</li> <li><code>fromElements(elements: _*)</code>-从给定的对象序列创建数据集。所有对象必须具有相同的类型。</li> <li><code>fromParallelCollection(SplittableIterator)</code>-从迭代器并行创建数据集。该类指定迭代器返回的元素的数据类型。</li> <li><code>generateSequence(from, to)</code> -并行生成给定间隔中的数字序列。</li></ul> <h3 id="_2-3-通用："><a href="#_2-3-通用：" class="header-anchor">#</a> 2.3 通用：</h3> <ul><li><code>readFile(inputFormat, path)// FileInputFormat</code>-接受文件输入格式。</li> <li><code>createInput(inputFormat)// InputFormat</code>-接受通用输入格式。</li></ul> <h2 id="_3-程序数据输出（data-sinks）"><a href="#_3-程序数据输出（data-sinks）" class="header-anchor">#</a> 3 程序数据输出（Data Sinks）</h2> <ul><li><code>writeAsText()</code>// TextOutputFormat-将元素按行写为字符串。通过调用每个元素的 toString（）方法获得字符串。</li> <li><code>writeAsCsv(...)</code>// CsvOutputFormat-将元组写为逗号分隔的值文件。行和字段定界符是可配置的。每个字段的值来自对象的 toString（）方法。</li> <li><code>print()</code>// printToErr()- 在标准输出/标准错误流上打印每个元素的 toString（）值。</li> <li><code>write()</code>// FileOutputFormat-自定义文件输出的方法和基类。支持自定义对象到字节的转换。</li> <li><code>output()</code>// OutputFormat-最通用的输出方法，用于不基于文件的数据接收器（例如将结果存储在数据库中）。</li></ul> <h2 id="_4-转换操作（transformations）"><a href="#_4-转换操作（transformations）" class="header-anchor">#</a> 4 转换操作（Transformations）</h2> <h3 id="_4-1-map"><a href="#_4-1-map" class="header-anchor">#</a> 4.1 Map</h3> <p>Map 转换将用户定义的 map 函数应用于 DataSet 的每个元素。它实现了一对一的映射，也就是说，函数必须恰好返回一个元素。</p> <div class="language- extra-class"><pre class="language-text"><code>val intPairs: DataSet[(Int, Int)] = // [...]
val intSums = intPairs.map { pair =&gt; pair._1 + pair._2 }
</code></pre></div><h3 id="_4-2-flatmap"><a href="#_4-2-flatmap" class="header-anchor">#</a> 4.2 FlatMap</h3> <p>FlatMap 转换在数据集的每个元素上应用用户定义的 FlatMap 方法。映射函数的可以为每个输入元素返回任意许多结果元素（包括无结果元素）。</p> <div class="language- extra-class"><pre class="language-text"><code>val textLines: DataSet[String] = // [...]
val words = textLines.flatMap { _.split(&quot; &quot;) }
</code></pre></div><h3 id="_4-3-mappartition"><a href="#_4-3-mappartition" class="header-anchor">#</a> 4.3 MapPartition</h3> <p>MapPartition 在单个函数调用中转换并行分区。map-partition 函数将分区获取为 Iterable，并可以产生任意数量的结果值。每个分区中元素的数量取决于并行度和先前的操作。</p> <div class="language- extra-class"><pre class="language-text"><code>val textLines: DataSet[String] = // [...]
// 因为返回值必须是 Collection，所以需要 Some
// 从 Option 到 Collection 的隐式转换
val counts = texLines.mapPartition { in =&gt; Some(in.size) }
</code></pre></div><h3 id="_4-4-filter"><a href="#_4-4-filter" class="header-anchor">#</a> 4.4 Filter</h3> <p>Filter 转换将用户定义的过滤器功能应用于 DataSet 的每个元素，并仅保留函数返回的那些元素 true。</p> <div class="language- extra-class"><pre class="language-text"><code>val intNumbers: DataSet[Int] = // [...]
val naturalNumbers = intNumbers.filter { _ &gt; 0 }
</code></pre></div><h3 id="_4-5-projection-of-tuple-dataset（元组数据集投影）"><a href="#_4-5-projection-of-tuple-dataset（元组数据集投影）" class="header-anchor">#</a> 4.5 Projection of Tuple DataSet（元组数据集投影）</h3> <p>project 转换将删除或移动元组数据集的元组字段。该 project(int...) 方法选择应由其索引保留的元组字段，并在输出元组中定义其顺序。
project 不需要定义函数体</p> <div class="language- extra-class"><pre class="language-text"><code>DataSet&lt;Tuple3&lt;Integer, Double, String&gt;&gt; in = // [...]
// converts Tuple3&lt;Integer, Double, String&gt; into Tuple2&lt;String, Integer&gt;
DataSet&lt;Tuple2&lt;String, Integer&gt;&gt; out = in.project(2,0);
</code></pre></div><p><strong>带有类型提示的投影</strong><br>
请注意，Java 编译器无法推断 project 运算符的返回类型。如果您根据 project 运算符的结果调用另一个运算符，则可能会导致问题，例如：</p> <div class="language- extra-class"><pre class="language-text"><code>DataSet&lt;Tuple5&lt;String,String,String,String,String&gt;&gt; ds = ....
DataSet&lt;Tuple1&lt;String&gt;&gt; ds2 = ds.project(0).distinct(0);
</code></pre></div><p>可以通过如下提示 project 操作符的返回类型来克服此问题：</p> <div class="language- extra-class"><pre class="language-text"><code>DataSet&lt;Tuple1&lt;String&gt;&gt; ds2 = ds.&lt;Tuple1&lt;String&gt;&gt;project(0).distinct(0);
</code></pre></div><h3 id="_4-6-transformations-on-grouped-dataset（分组数据集的转换）"><a href="#_4-6-transformations-on-grouped-dataset（分组数据集的转换）" class="header-anchor">#</a> 4.6 Transformations on Grouped DataSet（分组数据集的转换）</h3> <p>reduce 操作可以对分组的数据集进行操作。指定用于分组的密钥可以通过多种方式完成：</p> <ul><li>关键表达，<code>groupBy(&quot;key&quot;)</code></li> <li>键选择器功能，<code>implements KeySelector</code></li> <li>一个或多个字段位置键（仅限元组数据集），<code>groupBy(0, 1)</code></li> <li>案例类别字段（仅案例类别），<code>groupBy(&quot;a&quot;, &quot;b&quot;)</code></li></ul> <h3 id="_4-7-reduce-on-grouped-dataset（减少分组数据集）"><a href="#_4-7-reduce-on-grouped-dataset（减少分组数据集）" class="header-anchor">#</a> 4.7 Reduce on Grouped DataSet（减少分组数据集）</h3> <p>应用于分组数据集的 Reduce 转换使用用户定义的 reduce 函数将每个组简化为单个元素。<br>
对于每组输入元素，reduce 函数依次将成对的元素组合为一个元素，直到每组只剩下一个元素为止。</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token comment">// some ordinary POJO</span>
<span class="token keyword">class</span> WC<span class="token punctuation">(</span><span class="token keyword">val</span> word<span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token keyword">val</span> count<span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">def</span> <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// [...]</span>
<span class="token punctuation">}</span>

<span class="token keyword">val</span> words<span class="token operator">:</span> DataSet<span class="token punctuation">[</span>WC<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token comment">// [...]</span>
<span class="token keyword">val</span> wordCounts <span class="token operator">=</span> words<span class="token punctuation">.</span>groupBy <span class="token punctuation">{</span> _<span class="token punctuation">.</span>word <span class="token punctuation">}</span> reduce <span class="token punctuation">{</span>
  <span class="token punctuation">(</span>w1<span class="token punctuation">,</span> w2<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token keyword">new</span> WC<span class="token punctuation">(</span>w1<span class="token punctuation">.</span>word<span class="token punctuation">,</span> w1<span class="token punctuation">.</span>count <span class="token operator">+</span> w2<span class="token punctuation">.</span>count<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-8-groupreduce-on-grouped-dataset（分组数据集上的-groupreduce）"><a href="#_4-8-groupreduce-on-grouped-dataset（分组数据集上的-groupreduce）" class="header-anchor">#</a> 4.8 GroupReduce on Grouped DataSet（分组数据集上的 GroupReduce）</h3> <p>应用于分组数据集的 GroupReduce 转换为每个组调用用户定义的 group-reduce 函数。<br>
此与 Reduce 的区别在于，用户定义的函数可一次获取整个组。该函数在组的所有元素上使用 Iterable 调用，并且可以返回任意数量的结果元素。</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> input<span class="token operator">:</span> DataSet<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token comment">// [...]</span>
<span class="token keyword">val</span> output <span class="token operator">=</span> input<span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>reduceGroup <span class="token punctuation">{</span>
      <span class="token punctuation">(</span>in<span class="token punctuation">,</span> out<span class="token operator">:</span> Collector<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">=&gt;</span>
        in<span class="token punctuation">.</span>toSet foreach <span class="token punctuation">(</span>out<span class="token punctuation">.</span>collect<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-9-可组合的-groupreduce-函数"><a href="#_4-9-可组合的-groupreduce-函数" class="header-anchor">#</a> 4.9 可组合的 GroupReduce 函数</h3> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">object</span> GroupReduceOnCombinatorGroupReduceFunctions <span class="token keyword">extends</span> Transformations <span class="token punctuation">{</span>
  roleLoginDs
    <span class="token punctuation">.</span>map<span class="token punctuation">(</span>o <span class="token keyword">=&gt;</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span>uid<span class="token punctuation">,</span> o<span class="token punctuation">.</span>dataUnix<span class="token punctuation">,</span> o<span class="token punctuation">.</span>money<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>_1<span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">&quot;1|1051&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 筛选部分用户</span>
    <span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// 按用户 ID 分组</span>
    <span class="token punctuation">.</span>sortGroup<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> Order<span class="token punctuation">.</span>ASCENDING<span class="token punctuation">)</span> <span class="token comment">// 分组排序，按订单金额升序</span>
    <span class="token punctuation">.</span>reduceGroup<span class="token punctuation">(</span><span class="token keyword">new</span> MyCombinableGroupReducer<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>print<span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">/* sortGroup 后原始数据集
  (1|1051,1571798861,50.0)
  (1|1051,1571798861,64.0)
  (1|1051,1571798860,198.0)
  (1|1051,1571798859,328.0)
  (1|1051,1571798859,648.0)
 */</span>
 
   <span class="token comment">/* 计算结果为
  (1|1051,1571798859,976.0)
  (1|1051,1571798860,198.0)
  (1|1051,1571798861,114.0)
   */</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
  * 与 reduce 函数相比，group-reduce 函数不是可隐式组合的。
  * 为了使 group-reduce 函数可组合，它必须实现 GroupCombineFunction 接口。
  *
  * 要点：GroupCombineFunction 接口的通用输入和输出类型必须等于 GroupReduceFunction 的通用输入类型，
  * 如以下示例所示：
  */</span>
<span class="token keyword">import</span> <span class="token namespace">scala<span class="token punctuation">.</span>collection</span><span class="token punctuation">.</span>JavaConverters<span class="token punctuation">.</span>_

<span class="token keyword">class</span> MyCombinableGroupReducer
  <span class="token keyword">extends</span> GroupReduceFunction<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
    <span class="token keyword">with</span> GroupCombineFunction<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token punctuation">{</span>
  <span class="token keyword">override</span> <span class="token keyword">def</span> reduce<span class="token punctuation">(</span>values<span class="token operator">:</span> lang<span class="token punctuation">.</span>Iterable<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                      out<span class="token operator">:</span> Collector<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    values<span class="token punctuation">.</span>iterator<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>asScala<span class="token punctuation">.</span>foreach<span class="token punctuation">(</span>o <span class="token keyword">=&gt;</span> out<span class="token punctuation">.</span>collect<span class="token punctuation">(</span>o<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">override</span> <span class="token keyword">def</span> combine<span class="token punctuation">(</span>values<span class="token operator">:</span> lang<span class="token punctuation">.</span>Iterable<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
                       out<span class="token operator">:</span> Collector<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Unit</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> r <span class="token operator">=</span> values<span class="token punctuation">.</span>iterator<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>asScala<span class="token punctuation">.</span>reduce<span class="token punctuation">(</span><span class="token punctuation">(</span>o1<span class="token punctuation">,</span> o2<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token punctuation">(</span>o1<span class="token punctuation">.</span>_1<span class="token punctuation">,</span> o1<span class="token punctuation">.</span>_2<span class="token punctuation">,</span> o1<span class="token punctuation">.</span>_3 <span class="token operator">+</span> o2<span class="token punctuation">.</span>_3<span class="token punctuation">)</span><span class="token punctuation">)</span>
    out<span class="token punctuation">.</span>collect<span class="token punctuation">(</span>r<span class="token punctuation">)</span> <span class="token comment">// 合并相同 key 的价格</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-10-groupcombine-on-a-grouped-dataset（分组数据集上的-groupcombine）"><a href="#_4-10-groupcombine-on-a-grouped-dataset（分组数据集上的-groupcombine）" class="header-anchor">#</a> 4.10 GroupCombine on a Grouped DataSet（分组数据集上的 GroupCombine）</h3> <p>GroupCombine 转换是可组合 GroupReduceFunction 中的合并步骤的通用形式。<br>
从某种意义上讲，它是广义的，它允许将输入类型组合为 I 任意输出类型 O。<br>
相反，GroupReduce 中的 Combine 步骤仅允许从 input type I 到 output type 的组合 I。<br>
这是因为 GroupReduceFunction 中的 reduce 步骤需要输入类型 I。</p> <p>在一些应用中，期望在执行附加转换之前将数据集组合成中间格式（例如，以减小数据大小）。这可以通过具有很少成本的 CombineGroup 转换来实现。</p> <blockquote><p>注意：分组数据集上的 GroupCombine 使用贪婪策略在内存中执行，该策略可能不会一次处理所有数据，而是分多个步骤进行。它也可以在单个分区上执行，而无需像 GroupReduce 转换那样进行数据交换。这可能会导致部分结果。</p></blockquote> <p>下面的示例演示将 CombineGroup 转换用于替代 WordCount 实现。</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> input<span class="token operator">:</span> DataSet<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">]</span> <span class="token comment">// The words received as input</span>

<span class="token keyword">val</span> combinedWords<span class="token operator">:</span> DataSet<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> input
  <span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>combineGroup <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>words<span class="token punctuation">,</span> out<span class="token operator">:</span> Collector<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">=&gt;</span>
        <span class="token keyword">var</span> key<span class="token operator">:</span> <span class="token builtin">String</span> <span class="token operator">=</span> <span class="token keyword">null</span>
        <span class="token keyword">var</span> count <span class="token operator">=</span> <span class="token number">0</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span>word <span class="token keyword">&lt;-</span> words<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            key <span class="token operator">=</span> word
            count <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
        out<span class="token punctuation">.</span>collect<span class="token punctuation">(</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> count<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">val</span> output<span class="token operator">:</span> DataSet<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> combinedWords
  <span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span>reduceGroup <span class="token punctuation">{</span>
    <span class="token punctuation">(</span>words<span class="token punctuation">,</span> out<span class="token operator">:</span> Collector<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">=&gt;</span>
        <span class="token keyword">var</span> key<span class="token operator">:</span> <span class="token builtin">String</span> <span class="token operator">=</span> <span class="token keyword">null</span>
        <span class="token keyword">var</span> sum <span class="token operator">=</span> <span class="token number">0</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>word<span class="token punctuation">,</span> sum<span class="token punctuation">)</span> <span class="token keyword">&lt;-</span> words<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            key <span class="token operator">=</span> word
            sum <span class="token operator">+=</span> count
        <span class="token punctuation">}</span>
        out<span class="token punctuation">.</span>collect<span class="token punctuation">(</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> sum<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-11-aggregate-on-grouped-tuple-dataset（在分组元组数据集聚合）"><a href="#_4-11-aggregate-on-grouped-tuple-dataset（在分组元组数据集聚合）" class="header-anchor">#</a> 4.11 Aggregate on Grouped Tuple DataSet（在分组元组数据集聚合）</h3> <ul><li>有一些常用的聚合操作。聚合转换提供以下内置聚合功能：</li> <li>Sum</li> <li>Min, and</li> <li>Max</li></ul> <blockquote><p>聚合转换只能应用于元组数据集，并且仅支持用于分组的字段位置键。</p></blockquote> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token comment">// 角色付费数据 DataSet</span>
  <span class="token keyword">val</span> roleLoginDs <span class="token operator">=</span> DataSet<span class="token punctuation">.</span>rolePay<span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>

  <span class="token punctuation">{</span> <span class="token comment">// aggregate</span>
    roleLoginDs
      <span class="token punctuation">.</span>map<span class="token punctuation">(</span>o <span class="token keyword">=&gt;</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span>uid<span class="token punctuation">,</span> o<span class="token punctuation">.</span>dataUnix<span class="token punctuation">,</span> o<span class="token punctuation">.</span>money<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>_1<span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">&quot;0|102&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 筛选部分用户</span>
      <span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span>Aggregations<span class="token punctuation">.</span>SUM<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
      <span class="token comment">// .aggregate(Aggregations.MIN, 1)</span>
      <span class="token comment">// .andMin(1)</span>
      <span class="token punctuation">.</span>print<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">/*
    .aggregate(Aggregations.SUM, 2) 计算结果为
    (0|1021,1571473389,396.0)
    (0|1024,1571543169,50.0)
    (0|1025,1571420259,648.0)
    (0|1025_199,1571577819,648.0)
    */</span>
    <span class="token comment">/*
    .aggregate(Aggregations.SUM, 2).andMin(1) 计算结果为
    (0|1021,1571471529,396.0)
    (0|1024,1571543169,50.0)
    (0|1025,1571420259,648.0)
    (0|1025_199,1571577819,648.0)
     */</span>
    <span class="token comment">/*
    .aggregate(Aggregations.SUM, 2).aggregate(Aggregations.MIN, 1) 计算结果为
    (0|1025_199,1571420259,648.0)
     */</span>
  <span class="token punctuation">}</span>
</code></pre></div><p>要将多个聚合应用于一个 DataSet，必须.and() 在第一个聚合之后使用该函数，这意味着.aggregate(SUM, 0).and(MIN, 2) 产生原始 DataSet 的字段 0 之和和字段 2 的最小值。<br>
与此相反，.aggregate(SUM, 0).aggregate(MIN, 2) 将对聚合应用聚合。</p> <h3 id="_4-12-minby-maxby-on-grouped-tuple-dataset（分组元组数据集上的-minby-maxby）"><a href="#_4-12-minby-maxby-on-grouped-tuple-dataset（分组元组数据集上的-minby-maxby）" class="header-anchor">#</a> 4.12 MinBy / MaxBy on Grouped Tuple DataSet（分组元组数据集上的 MinBy / MaxBy）</h3> <p>MinBy（MaxBy）转换为每个元组组选择一个元组。<br>
选定的元组是其一个或多个指定字段的值最小（最大）的元组。用于比较的字段必须是有效的关键字段，即可比较的字段。<br>
如果多个元组具有最小（最大）字段值，则返回这些元组中的任意元组。</p> <div class="language-scala extra-class"><pre class="language-scala"><code>  roleLoginDs
    <span class="token punctuation">.</span>map<span class="token punctuation">(</span>o <span class="token keyword">=&gt;</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span>uid<span class="token punctuation">,</span> o<span class="token punctuation">.</span>dataUnix<span class="token punctuation">,</span> o<span class="token punctuation">.</span>money<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>_1<span class="token punctuation">.</span>contains<span class="token punctuation">(</span><span class="token string">&quot;1|1051&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>minBy<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>print<span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token comment">/* 原始数据集
  (1|1051,1571798859,648.0)
  (1|1051,1571798859,328.0)
  (1|1051,1571798860,198.0)
  (1|1051,1571798861,64.0)
  (1|1051,1571798861,50.0)
   */</span>

  <span class="token comment">/* 计算结果为
  (1|1051,1571798859,328.0)
   */</span>
</code></pre></div><h3 id="_4-13-reduce-on-full-dataset（减少完整的-dataset）"><a href="#_4-13-reduce-on-full-dataset（减少完整的-dataset）" class="header-anchor">#</a> 4.13 Reduce on full DataSet（减少完整的 DataSet）</h3> <p>Reduce 转换将用户定义的 reduce 函数应用于 DataSet 的所有元素。reduce 函数随后将成对的元素组合为一个元素，直到仅剩下一个元素为止。</p> <blockquote><p>使用 Reduce 转换来减少完整的 DataSet 意味着最终的 Reduce 操作不能并行进行。但是，reduce 函数可以自动组合，因此 Reduce 转换在大多数情况下都不会限制可伸缩性。</p></blockquote> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> intNumbers <span class="token operator">=</span> env<span class="token punctuation">.</span>fromElements<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token keyword">val</span> sum <span class="token operator">=</span> intNumbers<span class="token punctuation">.</span>reduce <span class="token punctuation">(</span>_ <span class="token operator">+</span> _<span class="token punctuation">)</span>
</code></pre></div><h3 id="_4-14-groupreduce-on-full-dataset（完整数据集上的-groupreduce）"><a href="#_4-14-groupreduce-on-full-dataset（完整数据集上的-groupreduce）" class="header-anchor">#</a> 4.14 GroupReduce on full DataSet（完整数据集上的 GroupReduce）</h3> <p>GroupReduce 转换在 DataSet 的所有元素上应用用户定义的 group-reduce 函数。group-reduce 可以迭代 DataSet 的所有元素并返回任意数量的结果元素</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> input<span class="token operator">:</span> DataSet<span class="token punctuation">[</span><span class="token builtin">Int</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token comment">// [...]</span>
<span class="token keyword">val</span> output <span class="token operator">=</span> input<span class="token punctuation">.</span>reduceGroup<span class="token punctuation">(</span><span class="token keyword">new</span> MyGroupReducer<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>注意：如果 group-reduce 函数不可组合，则无法并行完成对完整 DataSet 的 GroupReduce 转换。
因此，这可能是非常计算密集的操作。请参阅上面有关“可组合的 GroupReduce 函数”的段落，以了解如何实现可组合组简化函数。</p></blockquote> <h3 id="_4-15-groupcombine-on-a-full-dataset（完整数据集上的-groupcombine）"><a href="#_4-15-groupcombine-on-a-full-dataset（完整数据集上的-groupcombine）" class="header-anchor">#</a> 4.15 GroupCombine on a full DataSet（完整数据集上的 GroupCombine）</h3> <p>完整数据集上的 GroupCombine 与分组数据集上的 GroupCombine 相似。<br>
数据在所有节点上进行分区，然后以贪婪的方式进行组合（即，仅将适合内存的数据进行一次组合）。</p> <h3 id="_4-16-aggregate-on-full-tuple-dataset（完整数据集上聚合）"><a href="#_4-16-aggregate-on-full-tuple-dataset（完整数据集上聚合）" class="header-anchor">#</a> 4.16 Aggregate on full Tuple DataSet（完整数据集上聚合）</h3> <p>聚合转换只能应用于元组数据集。</p> <ul><li>有一些常用的聚合操作。聚合转换提供以下内置聚合功能：</li> <li>Sum</li> <li>Min, and</li> <li>Max</li></ul> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> input<span class="token operator">:</span> DataSet<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token comment">// [...]</span>
<span class="token keyword">val</span> output <span class="token operator">=</span> input<span class="token punctuation">.</span>aggregate<span class="token punctuation">(</span>SUM<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>and<span class="token punctuation">(</span>MIN<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_4-17-minby-maxby-on-full-tuple-dataset（完整数据集上的-minby-maxby）"><a href="#_4-17-minby-maxby-on-full-tuple-dataset（完整数据集上的-minby-maxby）" class="header-anchor">#</a> 4.17 MinBy/MaxBy on full Tuple DataSet（完整数据集上的 MinBy/MaxBy）</h3> <p>MinBy（MaxBy）转换从元组的数据集中选择一个元组。<br>
选定的元组是其一个或多个指定字段的值最小（最大）的元组。<br>
用于比较的字段必须是有效的关键字段，即可比较的字段。<br>
如果多个元组具有最小（最大）字段值，则返回这些元组中的任意元组。</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> input<span class="token operator">:</span> DataSet<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token comment">// [...]</span>
<span class="token keyword">val</span> output<span class="token operator">:</span> DataSet<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> input                          
                                   <span class="token punctuation">.</span>maxBy<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// select tuple with maximum values for first and third field.</span>
</code></pre></div><h3 id="_4-18-distinct（去重）"><a href="#_4-18-distinct（去重）" class="header-anchor">#</a> 4.18 Distinct（去重）</h3> <p>Distinct 转换计算源数据集的不同元素的数据集。以下代码从数据集中删除所有重复的元素：</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> input<span class="token operator">:</span> DataSet<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">,</span> <span class="token builtin">String</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token comment">// [...]</span>

<span class="token keyword">val</span> output <span class="token operator">=</span> input<span class="token punctuation">.</span>distinct<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 所有元组字段</span>
<span class="token keyword">val</span> output <span class="token operator">=</span> input<span class="token punctuation">.</span>distinct<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">// 指定具体元组字段位置</span>
<span class="token keyword">val</span> output <span class="token operator">=</span> input<span class="token punctuation">.</span>distinct <span class="token punctuation">{</span>x <span class="token keyword">=&gt;</span> Math<span class="token punctuation">.</span>abs<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token comment">// 使用  KeySelector 选择器</span>


<span class="token comment">// some ordinary POJO</span>
<span class="token keyword">case</span> <span class="token keyword">class</span> CustomType<span class="token punctuation">(</span>aName <span class="token operator">:</span> <span class="token builtin">String</span><span class="token punctuation">,</span> aNumber <span class="token operator">:</span> <span class="token builtin">Int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span>

<span class="token keyword">val</span> input<span class="token operator">:</span> DataSet<span class="token punctuation">[</span>CustomType<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token comment">// [...]</span>
<span class="token keyword">val</span> output <span class="token operator">=</span> input<span class="token punctuation">.</span>distinct<span class="token punctuation">(</span><span class="token string">&quot;aName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;aNumber&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 指定具体字段</span>
<span class="token keyword">val</span> output <span class="token operator">=</span> input<span class="token punctuation">.</span>distinct<span class="token punctuation">(</span><span class="token string">&quot;_&quot;</span><span class="token punctuation">)</span> <span class="token comment">// 也可以通过通配符指示使用所有字段：</span>
</code></pre></div><h3 id="_4-19-join"><a href="#_4-19-join" class="header-anchor">#</a> 4.19 Join</h3> <div class="language-scala extra-class"><pre class="language-scala"><code>
</code></pre></div><h3 id="_4-20-outerjoin"><a href="#_4-20-outerjoin" class="header-anchor">#</a> 4.20 OuterJoin</h3> <div class="language-scala extra-class"><pre class="language-scala"><code>
</code></pre></div><h3 id="_4-21-cross"><a href="#_4-21-cross" class="header-anchor">#</a> 4.21 Cross</h3> <p>Cross 转换将两个数据集组合为一个数据集。它构建两个输入数据集的元素的所有成对组合，即构建笛卡尔积。<br>
Cross 转换要么在每对元素上调用用户定义的交叉函数，要么输出 Tuple2</p> <h4 id="cross-with-自定义函数"><a href="#cross-with-自定义函数" class="header-anchor">#</a> Cross with 自定义函数</h4> <div class="language-scala extra-class"><pre class="language-scala"><code>roleLoginDs
    <span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>uid<span class="token punctuation">.</span>equals<span class="token punctuation">(</span><span class="token string">&quot;0|107&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>cross<span class="token punctuation">(</span>userLoginDs<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>uid<span class="token punctuation">.</span>equals<span class="token punctuation">(</span><span class="token string">&quot;0|107&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token punctuation">(</span>c1<span class="token punctuation">.</span>uid<span class="token punctuation">,</span> c2<span class="token punctuation">.</span>uid<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span>print<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="cross-with-数据集大小预估提示"><a href="#cross-with-数据集大小预估提示" class="header-anchor">#</a> Cross with 数据集大小预估提示</h4> <div class="language-scala extra-class"><pre class="language-scala"><code>  <span class="token comment">// crossWithTiny =&gt; 告诉系统假定右侧比左侧小很多</span>
  roleLoginDs
    <span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>uid<span class="token punctuation">.</span>equals<span class="token punctuation">(</span><span class="token string">&quot;0|107&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>crossWithTiny<span class="token punctuation">(</span>userLoginDs<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>uid<span class="token punctuation">.</span>equals<span class="token punctuation">(</span><span class="token string">&quot;0|107&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token punctuation">(</span>c1<span class="token punctuation">.</span>uid<span class="token punctuation">,</span> c2<span class="token punctuation">.</span>uid<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span>print<span class="token punctuation">(</span><span class="token punctuation">)</span>

  <span class="token comment">// crossWithHuge =&gt; 告诉系统假定左侧比右侧小很多</span>
  roleLoginDs
    <span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>uid<span class="token punctuation">.</span>equals<span class="token punctuation">(</span><span class="token string">&quot;0|107&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>crossWithHuge<span class="token punctuation">(</span>userLoginDs<span class="token punctuation">.</span>filter<span class="token punctuation">(</span>_<span class="token punctuation">.</span>uid<span class="token punctuation">.</span>equals<span class="token punctuation">(</span><span class="token string">&quot;0|107&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token punctuation">(</span>c1<span class="token punctuation">.</span>uid<span class="token punctuation">,</span> c2<span class="token punctuation">.</span>uid<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token punctuation">.</span>print<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_4-22-cogroup"><a href="#_4-22-cogroup" class="header-anchor">#</a> 4.22 CoGroup</h3> <p>CoGroup 转换共同处理两个数据集的组。两个数据集都分组在一个定义的键上，并且两个共享相同键的数据集的组一起交给用户定义的 co-group function。<br>
如果对于一个特定的键，只有一个 DataSet 有一个组，则使用该组和一个空组调用共同组功能。协同功能可以分别迭代两个组的元素并返回任意数量的结果元素。</p> <p>与 Reduce，GroupReduce 和 Join 相似，可以使用不同的键选择方法来定义键。</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> iVals<span class="token operator">:</span> DataSet<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token comment">// [...]</span>
<span class="token keyword">val</span> dVals<span class="token operator">:</span> DataSet<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token comment">// [...]</span>

<span class="token keyword">val</span> output <span class="token operator">=</span> iVals<span class="token punctuation">.</span>coGroup<span class="token punctuation">(</span>dVals<span class="token punctuation">)</span><span class="token punctuation">.</span>where<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>equalTo<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token punctuation">(</span>iVals<span class="token punctuation">,</span> dVals<span class="token punctuation">,</span> out<span class="token operator">:</span> Collector<span class="token punctuation">[</span><span class="token builtin">Double</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">=&gt;</span>
    <span class="token keyword">val</span> ints <span class="token operator">=</span> iVals map <span class="token punctuation">{</span> _<span class="token punctuation">.</span>_2 <span class="token punctuation">}</span> toSet

    <span class="token keyword">for</span> <span class="token punctuation">(</span>dVal <span class="token keyword">&lt;-</span> dVals<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">&lt;-</span> ints<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        out<span class="token punctuation">.</span>collect<span class="token punctuation">(</span>dVal<span class="token punctuation">.</span>_2 <span class="token operator">*</span> i<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-23-union"><a href="#_4-23-union" class="header-anchor">#</a> 4.23 Union</h3> <p>产生两个必须具有相同类型的数据集的并集。可以通过多个联合调用实现两个以上 DataSet 的联合</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> vals1<span class="token operator">:</span> DataSet<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token comment">// [...]</span>
<span class="token keyword">val</span> vals2<span class="token operator">:</span> DataSet<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token comment">// [...]</span>
<span class="token keyword">val</span> vals3<span class="token operator">:</span> DataSet<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token comment">// [...]</span>

<span class="token keyword">val</span> unioned <span class="token operator">=</span> vals1<span class="token punctuation">.</span>union<span class="token punctuation">(</span>vals2<span class="token punctuation">)</span><span class="token punctuation">.</span>union<span class="token punctuation">(</span>vals3<span class="token punctuation">)</span>
</code></pre></div><h3 id="_4-24-rebalance-重新平衡"><a href="#_4-24-rebalance-重新平衡" class="header-anchor">#</a> 4.24 Rebalance(重新平衡)</h3> <p>均匀地重新平衡数据集的并行分区，以消除数据偏斜。<br> <strong>重要</strong>：此操作会通过网络重新整理整个 DataSet。可能会花费大量时间。</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> in<span class="token operator">:</span> DataSet<span class="token punctuation">[</span><span class="token builtin">String</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token comment">// [...]</span>
<span class="token comment">// rebalance DataSet and apply a Map transformation.</span>
<span class="token keyword">val</span> out <span class="token operator">=</span> in<span class="token punctuation">.</span>rebalance<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>map <span class="token punctuation">{</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> <span class="token punctuation">}</span>
</code></pre></div><h3 id="_4-25-hash-partition-哈希分区"><a href="#_4-25-hash-partition-哈希分区" class="header-anchor">#</a> 4.25 Hash-Partition(哈希分区)</h3> <p><strong>重要</strong>：此操作会通过网络重新整理整个 DataSet。可能会花费大量时间。</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token punctuation">.</span>partitionByHash<span class="token punctuation">(</span>_<span class="token punctuation">.</span>dataUnix<span class="token punctuation">)</span>
</code></pre></div><h3 id="_4-26-range-partition（范围分区）"><a href="#_4-26-range-partition（范围分区）" class="header-anchor">#</a> 4.26 Range-Partition（范围分区）</h3> <p><strong>重要</strong>：此操作需要在 DataSet 上额外传递一次以计算范围，通过网络对整个 DataSet 进行边界划分和改组。这会花费大量时间。</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token punctuation">.</span>partitionByRange<span class="token punctuation">(</span>_<span class="token punctuation">.</span>dataUnix<span class="token punctuation">)</span>
</code></pre></div><h3 id="_4-27-sort-partition（分区排序）"><a href="#_4-27-sort-partition（分区排序）" class="header-anchor">#</a> 4.27 Sort Partition（分区排序）</h3> <p>以指定顺序对指定字段上的 DataSet 的所有分区进行<strong>本地排序</strong>。可以将字段指定为字段表达式或字段位置。<br>
可以通过链接 sortPartition() 调用在多个字段上对分区进行排序。</p> <div class="language-scala extra-class"><pre class="language-scala"><code>  roleLoginDs
    <span class="token punctuation">.</span>sortPartition<span class="token punctuation">(</span>_<span class="token punctuation">.</span>dataUnix<span class="token punctuation">,</span> Order<span class="token punctuation">.</span>ASCENDING<span class="token punctuation">)</span>
    <span class="token punctuation">.</span>sortPartition<span class="token punctuation">(</span>_<span class="token punctuation">.</span>uid<span class="token punctuation">,</span> Order<span class="token punctuation">.</span>DESCENDING<span class="token punctuation">)</span>
    <span class="token punctuation">.</span>mapPartition<span class="token punctuation">(</span><span class="token punctuation">(</span>values<span class="token operator">:</span> lang<span class="token punctuation">.</span>Iterable<span class="token punctuation">[</span>RolePay<span class="token punctuation">]</span><span class="token punctuation">,</span> out<span class="token operator">:</span> Collector<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">,</span> <span class="token builtin">Double</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">=&gt;</span> <span class="token punctuation">{</span>
      values<span class="token punctuation">.</span>iterator<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>asScala<span class="token punctuation">.</span>foreach<span class="token punctuation">(</span>o <span class="token keyword">=&gt;</span> out<span class="token punctuation">.</span>collect<span class="token punctuation">(</span>o<span class="token punctuation">.</span>rid<span class="token punctuation">,</span> o<span class="token punctuation">.</span>dataUnix<span class="token punctuation">,</span> o<span class="token punctuation">.</span>money<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span>print<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_4-28-first-n（前-n-个（任意）元素）"><a href="#_4-28-first-n（前-n-个（任意）元素）" class="header-anchor">#</a> 4.28 First-n（前 n 个（任意）元素）</h3> <p>返回数据集的前 n 个（任意）元素。First-n 可以应用于常规数据集，分组的数据集或分组排序的数据集。可以将分组键指定为键选择器功能或字段位置键。</p> <div class="language-scala extra-class"><pre class="language-scala"><code><span class="token keyword">val</span> in<span class="token operator">:</span> DataSet<span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token builtin">String</span><span class="token punctuation">,</span> <span class="token builtin">Int</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token comment">// [...]</span>
<span class="token comment">// Return the first five (arbitrary) elements of the DataSet</span>
<span class="token keyword">val</span> out1 <span class="token operator">=</span> in<span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>

<span class="token comment">// Return the first two (arbitrary) elements of each String group</span>
<span class="token keyword">val</span> out2 <span class="token operator">=</span> in<span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>

<span class="token comment">// Return the first three elements of each String group ordered by the Integer field</span>
<span class="token keyword">val</span> out3 <span class="token operator">=</span> in<span class="token punctuation">.</span>groupBy<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span>sortGroup<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> Order<span class="token punctuation">.</span>ASCENDING<span class="token punctuation">)</span><span class="token punctuation">.</span>first<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">最后修改时间:</span> <span class="time">2/17/2020, 4:43:04 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/framework/flink-basis/Environment概览.html" class="prev">
        Environment概览
      </a></span> <span class="next"><a href="/framework/flink-basis/DataSet分配唯一标识符.html">
        DataSet分配唯一标识符
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----><div class="reading-progress top" data-v-56679cca><div class="progress" data-v-56679cca></div></div></div></div>
    <script src="/assets/js/app.50205751.js" defer></script><script src="/assets/js/2.d9cbdc2c.js" defer></script><script src="/assets/js/43.3bb77f33.js" defer></script>
  </body>
</html>
